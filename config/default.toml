[general]
name = "OpenIntentOS"
data_dir = "data"
log_level = "info"

[bot]
# Number of conversation history messages to load per request (reduce to save tokens)
history_window = 20
# Show token usage stats after each response (false = log only, true = also show in chat)
show_token_usage = false
# Simple query threshold: messages shorter than this (chars) use a cheaper model
# Set to 0 to disable smart routing
simple_query_threshold = 120

# ---------------------------------------------------------------------------
# LLM Configuration
# ---------------------------------------------------------------------------
#
# Provider auto-detection order (when OPENINTENT_PROVIDER is not set):
#   1. ANTHROPIC_API_KEY  -> Anthropic (claude-sonnet-4-20250514)
#   2. OPENAI_API_KEY     -> OpenAI   (gpt-4o)
#   3. DEEPSEEK_API_KEY   -> DeepSeek (deepseek-chat)
#   4. Claude Code OAuth  -> Anthropic via macOS Keychain token
#   5. Ollama (local)     -> qwen2.5:latest at localhost:11434
#
# Environment variables:
#   OPENINTENT_PROVIDER      - Force a specific provider: anthropic, openai, deepseek, ollama
#   OPENINTENT_MODEL         - Override the default model for the selected provider
#   OPENINTENT_API_BASE_URL  - Override the base URL for the selected provider
#   OPENINTENT_API_KEY       - Generic API key (used with custom providers)

[llm]
provider = "openai"
model = "gpt-4o"
max_tokens = 4096
temperature = 0.0

[llm.anthropic]
# Set via ANTHROPIC_API_KEY environment variable
base_url = "https://api.anthropic.com"

[llm.openai]
# Set via OPENAI_API_KEY environment variable
base_url = "https://api.openai.com/v1"

[llm.deepseek]
# Set via DEEPSEEK_API_KEY environment variable
base_url = "https://api.deepseek.com/v1"

[llm.ollama]
# No API key required (local)
base_url = "http://localhost:11434/v1"

[kernel]
max_concurrent_tasks = 16
task_timeout_secs = 300

[vault]
db_path = "data/vault.db"

[store]
db_path = "data/openintent.db"
mmap_size = 268435456
cache_size = 64000

# ---------------------------------------------------------------------------
# Evolution Engine (auto-files GitHub issues for unhandled intents)
# ---------------------------------------------------------------------------
#
# Environment variables:
#   GITHUB_TOKEN                  - Required for issue creation (repo scope)
#   OPENINTENT_EVOLUTION_REPO     - owner/repo format (auto-detected from git remote if unset)
#   OPENINTENT_EVOLUTION_ENABLED  - true to enable (auto-enabled if GITHUB_TOKEN is set)

[evolution]
labels = ["auto-evolution", "unhandled-intent"]

# Phrases in agent responses that indicate inability to handle a request.
# The engine checks if the agent's response contains any of these (case-insensitive).
# Add phrases in any language your users may use.
failure_indicators = [
    # English
    "I can't",
    "I cannot",
    "I'm unable to",
    "I don't have the ability",
    "not supported",
    "no tool available",
    "unable to fulfill",
    "I don't have access to",
    "not currently able",
    "beyond my capabilities",
    "no adapter",
    "unknown tool",
    # Chinese
    "æˆ‘æ— æ³•",
    "æˆ‘ä¸èƒ½",
    "æ— æ³•å®Œæˆ",
    "æ²¡æœ‰è¿™ä¸ªåŠŸèƒ½",
    "æ²¡æœ‰é›†æˆ",
    "æš‚ä¸æ”¯æŒ",
    "ä¸æ”¯æŒ",
    "è¶…å‡ºäº†æˆ‘çš„èƒ½åŠ›",
    "ç›®å‰æ²¡æœ‰",
    "æ— æ³•ç›´æ¥",
]

# ---------------------------------------------------------------------------
# User-facing messages (English templates)
# ---------------------------------------------------------------------------
#
# All user-facing strings are defined here in English. The bot automatically
# translates them to the user's language via LLM at runtime.
# Placeholders use {name} syntax (e.g., {summary}).

[messages.self_repair]
started = "Found an issue, analyzing and fixing automatically..."
analyzing = "Analyzing code..."
fixing = "Fixing the issue..."
compiling = "Compiling and verifying..."
verifying = "Verifying the fix..."
check_failed = "Auto-fix failed: code verification didn't pass. I'll keep improving."
testing = "Running tests..."
test_failed = "Auto-fix failed: tests didn't pass. I'll keep improving."
building = "Building new version..."
build_failed = "Auto-fix failed: build error. I'll keep improving."
committing = "Saving the fix..."
pushing = "Pushing fix to remote repository..."
push_failed = "Fix saved locally, but push to remote failed. Will retry later."
waiting_for_release = "Fix pushed! CI is now building the release (~15 min). I'll download and restart automatically when it's ready..."
release_ready = "New release downloaded from CI. Restarting now..."
success = "I found and fixed an issue automatically!\n\nFix: {summary}\n\nRestarting now â€” please resend your message in a few seconds..."

[messages.errors]
general = "Sorry, something went wrong while processing your request. Please try again later or rephrase your message."
repair_failed = "Sorry, I encountered an issue and tried to fix it automatically, but it didn't work this time. The developer has been notified. Please try again later."

[messages.startup]
with_updates = "I just restarted with updates!\n\n{summary}"
simple = "I just restarted and I'm ready to help!"

[messages.bot]
token_usage = "ğŸ“Š tokens: â†‘{input} â†“{output} (total: {total})"
tokens_on = "Token usage display enabled for this chat."
tokens_off = "Token usage display disabled for this chat."
start = "Hello! I'm OpenIntentOS. Send me any message and I'll help you. I have access to filesystem, shell, web search, email, GitHub, and more.\n\nDev commands:\n/dev <instruction> - Create a self-development task\n/tasks - List your dev tasks\n/taskstatus <id> - Check task status\n/merge <id> - Merge a completed task\n/cancel <id> - Cancel a task"

[messages.update]
confirmed = "âœ… Updated v{from} â†’ {to}. Now running the latest version."

[messages.status]
researching = "ğŸ’¡ Diving deep into research like a detective!"
searching = "ğŸŒŸ Hunting for awesome info across the web!"
reading_page = "ğŸ“– Reading through this juicy content!"
reading_files = "ğŸ’« Browsing files like a bookworm!"
running_command = "âš¡ Running some terminal magic!"
accessing_memory = "ğŸ’­ Digging through my memories..."
github = "ğŸ’» Having a GitHub adventure!"
email = "ğŸ’Œ Managing your emails with care!"
calendar = "ğŸ¯ Calendar magic happening right now!"
telegram = "ğŸ‰ Telegram messaging fun time!"
web_fetch = "ğŸª Fetching web content like a pro!"
building = "âœ¨ Building something absolutely awesome!"
testing = "ğŸ­ Running tests (fingers crossed!)"
analyzing = "ğŸ¨ Analyzing data like a mad scientist!"
fixing = "ğŸ’ª Rolling up sleeves to fix things!"
compiling = "ğŸµ Compiling code (making sweet music!)"
